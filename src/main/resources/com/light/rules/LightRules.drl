package com.Light

// list import classes
import com.iotbpm.model.Devices;
import com.iotbpm.model.ServerEvent;

// default dialect for the semantic code will be MVEL
dialect "mvel"

rule "event=allEvents Rule"
    when
        $event : ServerEvent( $eventId : id, event == "allEvents" )
      	$device : Devices( $deviceId : id,  $eventId == id )
    then
		$device.action = "allEvents"; 
		$device.status = "Light " + $event.getLight();
		com.iotbpm.ui.MainWindow.getInstance().log("Rule event=allEvents: " + $event.getEvent() + " - " + $event.getName() + " - " + " Light Value: " + $event.getLight());
		modify( $device );
end

rule "keypress1.0 Rule"
    when
        $event : ServerEvent( $eventId : id, event == "keypress1.0" )
      	$device : Devices( $deviceId : id,  $eventId == id )
    then
		$device.action = "keypress1.0"; 
		$device.status = "Light " + $event.getLight();
		com.iotbpm.ui.MainWindow.getInstance().log("Rule keypress1.0: " + $event.getEvent() + " - " + $event.getName() + " - " + " Light Value: " + $event.getLight());
		modify( $device );
end

rule "keypress2.0 Rule"
    when
        $event : ServerEvent( $eventId : id, event == "keypress2.0" )
      	$device : Devices( $deviceId : id,  $eventId == id )
    then
		$device.action = "keypress2.0"; 
		$device.status = "Light " + $event.getLight();
		com.iotbpm.ui.MainWindow.getInstance().log("Rule keypress2.0: " + $event.getEvent() + " - " + $event.getName() + " - " + " Light Value: " + $event.getLight());
		modify( $device );
end

rule "keypress4.0 reedRelay"
    when
        $event : ServerEvent( $eventId : id, event == "keypress4.0")
      	$device : Devices( $deviceId : id,  $eventId == id )
    then
		$device.action = "reedRelay"; 
		$device.status = "Light " + $event.getLight();
		com.iotbpm.ui.MainWindow.getInstance().log("Rule keypress4.0 reedRelay: " + $event.getEvent() + " - " + $event.getName() + " - " + " Light Value: " + $event.getLight());
		modify( $device );
end

rule "keypress8.0 proximity"
    when
        $event : ServerEvent( $eventId : id, event == "keypress8.0") 
      	$device : Devices( $deviceId : id,  $eventId == id )
    then
		$device.action = "proximity"; 
		$device.status = "Light " + $event.getLight();
		com.iotbpm.ui.MainWindow.getInstance().log("Rule keypress8.0 proximity: " + $event.getEvent() + " - " + $event.getName() + " - " + " Light Value: " + $event.getLight());
		modify( $device );
end

//declare any ruleflow-group rules to fire in the jBPM com.Light process
rule "Rule for device ID: 100111"
	ruleflow-group "Light Rule Flow"
	when
		$event : ServerEvent( $eventId : id, $eventId == "100111" )
	then
		com.iotbpm.ui.MainWindow.getInstance().log("ruleflow-group device ID: 100111 " + $event.getName() + " - " + $event.getEvent());
end

rule "Rule for device ID: 100222"
	ruleflow-group "Light Rule Flow"
	when
		$event : ServerEvent( $eventId : id, $eventId == "100222" )
	then
		com.iotbpm.ui.MainWindow.getInstance().log("ruleflow-group device ID: 100222 " + $event.getName() + " - " + $event.getEvent());
end
